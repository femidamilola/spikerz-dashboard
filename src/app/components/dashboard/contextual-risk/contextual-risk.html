<div class="contextual-risk-container">
  <table class="risk-table">
    <thead>
      <tr>
        <th class="header-asset">
          {{ i18nService.contextualRisk.table_headers.asset }}
        </th>
        <th class="header-risk">
          {{ i18nService.contextualRisk.table_headers.contextual_risk }}
        </th>
      </tr>
    </thead>
    <tbody>
      @for (risk of risks; track $index) {
      <tr class="asset-item" (click)="onAssetClick(risk)">
        <td>
          <div class="asset-content">
            <div class="asset-icon">
              <app-custom-icon [label]="'server'" />
            </div>
            <div class="asset-details">
              <div class="asset-name">{{ risk.name }}</div>
              <div class="asset-ip">{{ risk.ip }}</div>
            </div>
          </div>
        </td>
        <td>
          <div class="risk-badge">
            <span
              class="risk-level"
              [class.critical]="risk.isCritical"
              [class.high]="!risk.isCritical && risk.vulnerabilities.length > 2"
              [class.medium]="
                !risk.isCritical && risk.vulnerabilities.length === 2
              "
              [class.low]="
                !risk.isCritical && risk.vulnerabilities.length === 1
              "
            >
              @if (risk.isCritical) {
              <strong>Critical</strong>
              } @else if (risk.vulnerabilities.length > 2) {
              <strong>High</strong>
              } @else if (risk.vulnerabilities.length === 2) {
              <strong>Medium</strong>
              } @else {
              <strong>Low</strong>
              }
            </span>
          </div>
        </td>
      </tr>
      }
    </tbody>
  </table>

  <div class="pagination">
    <button
      class="pagination-btn"
      [disabled]="!canGoToPrevious"
      (click)="previousPage()"
    >
      <svg width="16" height="16" viewBox="0 0 16 16" fill="none">
        <path
          d="M10 12L6 8L10 4"
          [attr.stroke]="canGoToPrevious ? '#525d73' : '#9aa0a6'"
          stroke-width="2"
          stroke-linecap="round"
        />
      </svg>
    </button>
    <span class="pagination-text">
      {{ i18nService.contextualRisk.pagination.showing }}
      {{ startItem }}-{{ endItem }}
      {{ i18nService.contextualRisk.pagination.of }} {{ totalItems }}
    </span>
    <button
      class="pagination-btn"
      [disabled]="!canGoToNext"
      (click)="nextPage()"
    >
      <svg width="16" height="16" viewBox="0 0 16 16" fill="none">
        <path
          d="M6 4L10 8L6 12"
          [attr.stroke]="canGoToNext ? '#525d73' : '#9aa0a6'"
          stroke-width="2"
          stroke-linecap="round"
        />
      </svg>
    </button>
  </div>
</div>
